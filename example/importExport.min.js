let e={lehgthCal:14,endtime:"17:00",period:60,worktime:["09:00","19:00"],lunch:["12:00",60],orgWeekend:{"Сб":"14:00","Вс":""},restDayTime:{"2024-03-22":[],"2024-04-03":[],"2024-04-21":["16:00","17:00","18:00"],"2024-04-28":["10:00","11:00","14:00"]},holiday:["2024-02-23","2024-03-08","2024-05-01","2024-06-12","2024-06-30"],existAppDateTimeArr:{},servDuration:"120",locale:"ru-RU",long:"short",daysOfWeek:["Пн","Вт","Ср","Чт","Пт","Сб","Вс"],dw:["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],monthsFullName:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],monthsShortName:["Янв","Фев","Мар","Апр","Май","Июн","Июл","Авг","Сен","Окт","Ноя","Дек"]};function t(e,t){let s=Object.keys(e);s&&s.forEach((function(s){t.hasOwnProperty(s)&&(t[s]=e[s])}))}let s={appointmentTag:"appointment_tag",formId:"zapis_usluga_form",formMethod:"POST",formAction:"",divForTimeChoiceId:"time_choice",buttonsDivId:"buttons_div",buttonsDivClassName:"hor_center buts",buttonSubmitId:"zapis_usluga_form_sub",buttonsSubmitClassName:"but",buttonSubmitText:"Готово",buttonResetId:"zapis_usluga_form_res",buttonResetText:"Сбросить",buttonsResetClassName:"but"};class i{constructor(e,t){this.data=e,this.setCalsetValue=t}async data_from_db(e,t="",s="",i=""){const n=new Request(e,{method:"POST",mode:"same-origin",cache:"no-cache",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/x-www-form-urlencoded","X-CSRF-TOKEN":i},redirect:"follow",referrerPolicy:"no-referrer",body:"master_id="+s+"&service_id="+t}),a=await fetch(n);if(!a.ok)throw new Error(`Error! status: ${a.status}`);const r=a.headers.get("content-type");if(!r||!r.includes("application/json"))throw new TypeError("Data from server is not JSON!");return await a.json()}}class n{constructor(e,t){this.FormConfig=e,this.Calset=t,this.time_not_allowed=1}pad(e){return e<10?"0"+e:e}capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}dateAdd(e,t,s){if(e instanceof Date){var i=new Date(e),n=function(){i.getDate()!=e.getDate()&&i.setDate(0)};switch(String(t).toLowerCase()){case"year":i.setFullYear(i.getFullYear()+s),n();break;case"quarter":i.setMonth(i.getMonth()+3*s),n();break;case"month":i.setMonth(i.getMonth()+s),n();break;case"week":i.setDate(i.getDate()+7*s);break;case"day":i.setDate(i.getDate()+s);break;case"hour":i.setTime(i.getTime()+36e5*s);break;case"minute":i.setTime(i.getTime()+6e4*s);break;case"second":i.setTime(i.getTime()+1e3*s);break;default:i=void 0}return i}}getDaysArray(e,t){for(var s=[],i=new Date(e);i<=new Date(t);i.setDate(i.getDate()+1))i.setHours(0,0,0,0),s.push(new Date(i));return s}work_time_start_dt(e){const t=this.Calset.worktime[0].split(":");return new Date(e).setHours(t[0],t[1])}work_time_end_dt(e){const t=this.Calset.worktime[1].split(":");return new Date(e).setHours(t[0],t[1])}getDayName(e,t,s){return e||(e=new Date),new Date(e).toLocaleDateString(t,{weekday:s})}round_period(e){let t;return t=e<10?60*e:e>5&&e<16?15:10*Math.ceil(Number(e/10)),t}lunch(e){const t=this.Calset.lunch[0].split(":"),s=t[0],i=t[1],n=this.Calset.lunch[1],a=new Date(new Date(e).setHours(s,i,0,0));return[a,this.dateAdd(a,"minute",n)]}all_dates(){let e=Date.now(),t=(new Date).setDate((new Date).getDate()+(this.Calset.lehgthCal-1)),s=this.getDaysArray(e,t),i=new Date,n=this.Calset.endtime.split(":"),a=new Date(new Date(i).setHours(n[0],n[1]));if(i.getTime()>a.getTime()){let e=s.at(-1),t=new Date(e),i=t.setDate(t.getDate()+1);s.push(new Date(i)),s.shift()}return s}holidays(){if("Array"==this.Calset.holiday.constructor.name)var e=this.Calset.holiday.map((e=>new Date(e).setHours(0,0,0,0)));return e}rest_days(){var e=[];for(const t in this.Calset.restDayTime)if(Object.hasOwnProperty.call(this.Calset.restDayTime,t)){new Date(t).setHours(0,0,0,0);if(this.Calset.restDayTime[t].length<=0){let s=new Date(t).setHours(0,0,0,0);e.push(s)}}return e}markedDates(){let e=this.holidays(),t=this.rest_days(),s=this.all_dates(),i={};for(let n=0;n<s.length;n++){let a=s[n];a.getFullYear();const r=a.getMonth(),o=a.getDate();this.pad(r+1),this.pad(o);if(e?e.includes(a.getTime()):[]){i[a]="disabled";continue}const l=this.getDayName(a,this.Calset.locale,this.Calset.long),d=this.capitalizeFirstLetter(l);if(l in this.Calset.orgWeekend&&(""===this.Calset.orgWeekend[l]||null===this.Calset.orgWeekend[l])||d in this.Calset.orgWeekend&&(""===this.Calset.orgWeekend[d]||null===this.Calset.orgWeekend[d])){i[a]="disabled";continue}t.includes(a.getTime())?i[a]="disabled":i[a]=""}for(const e in i)if(Object.hasOwnProperty.call(i,e)){if(""===i[e]){i[e]="checked";break}}return i}times(e){const t=this.round_period(this.Calset.period),s=e?new Date(e):new Date,i=s.getFullYear(),n=s.getMonth(),a=s.getDate();let r=this.lunch(e),o=r[0],l=r[1],d={},c=this.Calset.worktime[0].split(":"),m=this.Calset.worktime[1].split(":");const h=new Date(i,n,a,c[0],c[1],0,0),u=new Date(i,n,a,m[0],m[1],0,0);for(let e=h;e<u;e=this.dateAdd(e,"minute",t))(e<o||e>=l)&&(d[e]="");return o in d||(d[o]="disabled"),l in d||(d[l]=""),d}date_times(){let e=this.markedDates(),t={};for(const s in e)if(Object.hasOwnProperty.call(e,s)){const i=e[s];""!==i&&"checked"!==i||(t[s]=this.times(s))}return t}rest_dt(){let e=this.round_period(this.Calset.period),t={};for(const s in this.Calset.restDayTime)if(Object.hasOwnProperty.call(this.Calset.restDayTime,s)){const i=this.Calset.restDayTime[s];if(i.length>0){t[s]={};for(let n=0;n<i.length;n++){const a=i[n].split(":"),r=a[0],o=a[1],l=new Date(new Date(s).setHours(r,o,0,0)),d=new Date(this.dateAdd(new Date(l),"minute",e).getTime());t[s][l]="disabled",d<this.work_time_end_dt(s)&&(d in t[s]||(t[s][d]=""))}}}let s=this.date_times();for(const e in s)if(Object.hasOwnProperty.call(s,e)){const i=s[e];for(const n in t)if(Object.hasOwnProperty.call(t,n)){const a=t[n];for(const t in a)Object.hasOwnProperty.call(a,t)&&(t in i&&""===i[t]?s[e][t]=a[t]:e!==n||t in i||(s[e][t]=a[t]))}}return s}appTimes(){let e=this.round_period(this.Calset.period),t=this.rest_dt(),s={},i={};for(const t in this.Calset.existAppDateTimeArr)if(Object.hasOwnProperty.call(this.Calset.existAppDateTimeArr,t)){const n=new Date(new Date(t).setHours(0,0,0,0));s[n]={},i[n]=[];const a=this.Calset.existAppDateTimeArr[t];for(const r in a)if(Object.hasOwnProperty.call(a,r)){let o="",l=r.split(":");const d=new Date(new Date(t).setHours(l[0],l[1])),c=a[r];if(c){const e=c>5?"minute":"hour",t=c>5?c:10*Math.ceil(Number(60*c/10));o=this.dateAdd(d,e,t)}else o=this.dateAdd(d,"minute",e);s[n][d]="disabled",i[n].push([d,o]),o<this.work_time_end_dt(n)&&(o in s[n]||(s[n][o]=""))}}for(const e in s)if(Object.hasOwnProperty.call(s,e)){const i=s[e];if(e in t)for(const s in i)if(Object.hasOwnProperty.call(i,s)){let n=i[s];s in t[e]&&"disabled"!=t[e][s]&&(t[e][s]=n),s in t[e]||(t[e][s]=n)}}for(const e in i)if(Object.hasOwnProperty.call(i,e)){const s=i[e];if(e in t)for(let i=0;i<s.length;i++){const n=s[i];for(const s in t[e])if(Object.hasOwnProperty.call(t[e],s)){const i=t[e][s];(n[0].getTime()<new Date(s).getTime()||n[0].getTime()<new Date(s).getTime())&&n[1].getTime()>new Date(s).getTime()&&(""===i||null===i)&&(t[e][s]="disabled")}}}return t}weekend_times(){let e=this.appTimes(),t="";for(const s in e){const i=e[s],n=this.getDayName(new Date(s),this.Calset.locale,this.Calset.long),a=this.capitalizeFirstLetter(n);let r=n in this.Calset.orgWeekend,o=a in this.Calset.orgWeekend;if(!r||""===this.Calset.orgWeekend[n]&&null===this.Calset.orgWeekend[n]?!o||""===this.Calset.orgWeekend[a]&&null===this.Calset.orgWeekend[a]||(t=this.Calset.orgWeekend[a].split(":")):t=this.Calset.orgWeekend[n].split(":"),(r||o)&&""!==t){const n=t[0],a=t[1],r=new Date(new Date(s).setHours(n,a,0,0));for(const t in i)Object.hasOwnProperty.call(i,t)&&r.getTime()<=new Date(t).getTime()&&(e[s][t]="disabled")}}return e}sortDateTimeArr(){let e=this.weekend_times();for(const t in e)if(Object.hasOwnProperty.call(e,t)){const s=e[t],i=Object.keys(s).sort().reduce(((e,t)=>(e[t]=s[t],e)),{});e[t]=i}return e}buttonsListener(e){let t=this,s=document.querySelector(e),i=document.getElementById(this.FormConfig.buttonsDivId),n=document.getElementById(this.FormConfig.buttonSubmitId),a=document.getElementById(this.FormConfig.buttonResetId);s&&s.addEventListener("click",(function(t){if("disabled"!=t.target.disabled&&"time"==t.target.name&&(n.disabled=!0,i&&n)){let t=document.querySelectorAll(e+' input[name="time"]:checked');t&&t.length>0&&(i.scrollIntoView(),n.disabled=!1,n.focus(),a.setAttribute("type","reset"),a.disabled=!1)}})),a.addEventListener("click",(function(){n.disabled=!0})),n.addEventListener("click",(function(){let s=document.querySelectorAll(e+' input[name="time"]:checked');s&&s.length>0&&document.getElementById(t.FormConfig.formId).submit()}))}}function a(e){var t=document.createElement("div");let s;t.classList.add("modal"),t.id="alert",t.innerHTML="<div><p>"+e+'</p><button id="alert_ok">OK</button></div>',this.divForTimeChoice&&(s=this.divForTimeChoice),s.parentNode.insertBefore(t,s),document.body.style.overflow="hidden";let i=document.getElementById("alert_ok");i.focus(),i.addEventListener("click",(function(e){t.remove(),document.body.style.overflow="visible"}))}class r{constructor(e,t,s,i,n){this.divForTimeChoice=s,this.FormConfig=t,this.Calset=e,this.Com=i,this.modalAlert=n}servDurationF(){let e=document.getElementById(this.FormConfig.buttonSubmitId);const t=this.Calset.servDuration;if(this.divForTimeChoice){let s=document.querySelectorAll(".master_times");if(s){let i=this;s.forEach((s=>s.addEventListener("change",(function(s){let n,a;if(document.querySelector("#tableId > tbody")){let e=document.querySelector(".today");a=e?e.id.slice(2):null}else n=document.querySelector('input[type="radio"][name="date"]:checked'),a=n?n.value:null;let r=document.querySelector('input[type="radio"][name="time"]:checked');if(r&&a){let s=r.value;const n=(new Date).setTime(s),o=i.Com.dateAdd(new Date((new Date).setTime(s)),"minute",t).getTime(),l=new Date(new Date(n).setHours(0,0,0,0));let d=i.Com.work_time_end_dt((new Date).setTime(a));const c=i.Com.sortDateTimeArr();if(l in c){let t=Object.entries(c[l]);for(let s=0;s<t.length;s++){const a=t[s];if(new Date(a[0]).getTime()===n){let n=s+1;if(n===t.length){if(o>d){i.modalAlert(" Недостаточно времени для оказания услуги до конца рабочего дня.\n<br /> Пожалуйста, выберите другое время."),r.checked=!1,e.disabled=!0;break}}else if(n<t.length)for(;n<t.length;n++){let s=t[n],a=s[1],l=new Date(s[0]);if(a&&o>l){i.modalAlert(" Недостаточно свободного времени для оказания услуги.\n<br /> Пожалуйста, выберите другое время."),r.checked=!1,e.disabled=!0;break}}break}}}}}))))}}}}class o{constructor(e,t,s,i,n){this.Common=e,this.CalSet=t,this.ServDurationCheck=s,this.divId=i,this.div_id_for_times_out=n,this.DaysOfWeek=this.CalSet.daysOfWeek,this.Months=this.CalSet.monthsFullName;var a=new Date;this.currMonth=a.getMonth(),this.currYear=a.getFullYear(),this.currDay=a.getDate()}nextMonth(){11==this.currMonth?(this.currMonth=0,this.currYear=this.currYear+1):this.currMonth=this.currMonth+1,this.showcurr()}previousMonth(){0==this.currMonth?(this.currMonth=11,this.currYear=this.currYear-1):this.currMonth=this.currMonth-1,this.showcurr()}showcurr(){this.showMonth(this.currYear,this.currMonth)}showMonth(e,t){let s=this.Common.markedDates();var i=new Date(e,t,7).getDay(),n=new Date(e,t+1,0).getDate();0==t?new Date(e-1,11,0).getDate():new Date(e,t,0).getDate();var a='<table id="tableId" class="table_month_cal">';a+="<thead><tr>",a+='<td colspan="7" class="td_month_cal thead_td_month_cal">'+this.Months[t]+" "+e+"</td>",a+="</tr></thead>",a+='<tr class="days">';for(var r=0;r<this.DaysOfWeek.length;r++)a+='<td class="td_month_cal">'+this.DaysOfWeek[r]+"</td>";a+="</tr>";r=1;do{var o=new Date(e,t,r).getDay();if(1==o)a+="<tr>";else if(1==r){a+="<tr>";for(var l=0;l<i;l++)a+='<td class="not-current td_month_cal"></td>'}let d=new Date(this.currYear,this.currMonth,r,0,0,0,0);const c=d.getTime();if(d in s&&"disabled"!==s[d]?"checked"===s[d]?a+='<td class="today td_month_cal day" id="d_'+c+'">'+r+"</td>":a+='<td class="normal td_month_cal day" id="d_'+c+'">'+r+"</td>":a+='<td class="not-current td_month_cal day" id="d_'+c+'">'+r+"</td>",0==o)a+="</tr>";else if(r==n)for(;o<7;o++)a+='<td class="not-current td_month_cal"></td>';r++}while(r<=n);a+="</table>",document.getElementById(this.divId).innerHTML=a}no_active_times(){let e="";e+='<div class="master_times" > <p> Выберите дату перед выбором времени </p>';for(let t=0;t<7;t++)e+='<div class="master_time ">                                    <input type="radio"" id="t_'+t+'" name="time" value="" disabled />                                    <label for="t_'+t+'">1'+(t+1)+":00</label>                                  </div>";return e+="</div> ",e}times_show(e){let t=e.slice(2),s=new Date((new Date).setTime(t)),i="",n=this.Common.sortDateTimeArr(),a={weekday:this.CalSet.long,year:"numeric",month:"long",day:"numeric"};if(s in n){i+='<div class="master_times" style="" id="td_'+new Date(s).getTime()+'"> <p>'+this.Common.capitalizeFirstLetter(s.toLocaleDateString(this.CalSet.locale,a))+"</p>";const e=n[s];let t="";for(const s in e)t=new Date(s).getTime()<(new Date).addHours(this.Common.time_not_allowed)?"disabled":e[s],i+='<div class="master_time ">                            <input type="radio" id="t_'+new Date(s).getTime()+'" name="time" value="'+new Date(s).getTime()+'" '+t+' required />                            <label for="t_'+new Date(s).getTime()+'">'+this.Common.pad(new Date(s).getHours())+":"+this.Common.pad(new Date(s).getMinutes())+"</label>                          </div>";i+="</div> "}return i}serv_dur_month(){this.ServDurationCheck.servDurationF();let e=document.querySelector("#tableId > tbody"),t=this;e&&e.addEventListener("click",(function(e){t.ServDurationCheck.servDurationF()}))}listener(){let e=document.querySelector("#"+this.div_id_for_times_out),t=".master_times";if(e.innerHTML=this.no_active_times(),document.querySelector(".today")){let s=document.querySelector(".today").id;e.innerHTML=this.times_show(s),this.Common.buttonsListener(t)}var s=document.querySelectorAll(".normal.day, .today.day");let i=this;for(var n=0;n<s.length;n++)s[n].onclick=function(s){document.querySelector(".today")&&document.querySelector(".today").classList.remove("today"),s.target.classList.add("today");let n=s.target.id;e.innerHTML=i.times_show(n),i.Common.buttonsListener(t)};this.serv_dur_month()}}function l(e,t,s,i){s.classList.add("calendar-wrapper"),s.innerHTML='<h3 class="back shad rad pad margin_rlb1">Выберите дату и время</h3><button id="btnPrev" type="button"> < Предыдущий</button>                <button id="btnNext" type="button">Следующий > </button>                <div id="divCal"></div>                <div id="divTimes"></div>';var n=new o(e,t,i,"divCal","divTimes");function a(e){return document.getElementById(e)}n.showcurr(),n.listener(),a("btnNext").onclick=function(){n.nextMonth(),n.listener()},a("btnPrev").onclick=function(){n.previousMonth(),n.listener()}}class d{constructor(e,t,s){var i=e.markedDates();let n=Object.keys(i),a=e.sortDateTimeArr(),r='<div class="master_datetime">';r+=n.map((s=>'<div class="master_date">              <input type="radio" class="dat" id="d_'+new Date(s).getTime()+'" name="date" value="'+new Date(s).getTime()+'" '+i[s]+' required />              <label for="d_'+new Date(s).getTime()+'" class="dat_label">'+e.capitalizeFirstLetter(e.getDayName(s,t.locale,t.long))+"<br />"+e.pad(new Date(s).getDate())+" "+t.monthsShortName[new Date(s).getMonth()]+"</label>              </div>")).join("");for(const t in a)if(Object.hasOwnProperty.call(a,t)){r+='<div class="master_times" style="display:none;" id="td_'+new Date(t).getTime()+'"> ';const s=a[t];let i="";for(const t in s)i=new Date(t).getTime()<(new Date).addHours(e.time_not_allowed)?"disabled":s[t],r+='<div class="master_time ">                            <input type="radio" id="t_'+new Date(t).getTime()+'" name="time" value="'+new Date(t).getTime()+'" '+i+' required />                            <label for="t_'+new Date(t).getTime()+'">'+e.pad(new Date(t).getHours())+":"+e.pad(new Date(t).getMinutes())+"</label>                          </div>";r+="</div> "}r+="</div> ",s&&(s.innerHTML=r)}listener(e,t){let s=document.querySelector(".dat:checked"),i=!!s&&s.id,n=document.querySelector("#t"+i);n&&(n.style.display="block");let a=document.querySelectorAll(".dat");for(var r=0;r<a.length;r++)a[r].onclick=function(e){document.querySelectorAll(".master_times").forEach((function(t){t.id=="t"+e.target.id?t.style.display="":t.style.display="none"})),document.querySelectorAll('.master_datetime input[name="time"]').forEach((function(e){e.checked&&(e.checked=!1)}))};t.servDurationF();e.buttonsListener(".master_datetime")}}function c(e,t,s,i){new d(e,t,s).listener(e,i)}class m{constructor(e,t,s,i,n,a,r){this.CalSet=e,this.FormConfig=t,this.divForTimeChoice=s,this.Common=i,this.modalAlert=n,this.y=a||(new Date).getFullYear(),this.m=r||(new Date).getMonth(),this.dates=function(e,t){let s=[],i=new Date(e,t+1,0).getDate();for(let n=1;n<=i;n++){let i=new Date(e,t,n,0,0,0,0);s.push(i)}return s},this.next_month=function(){return 11==this.m?(this.m=0,this.y=this.y+1):this.m=this.m+1,this.current_month()},this.prev_month=function(){return 0==this.m?(this.m=11,this.y=this.y-1):this.m=this.m-1,this.current_month()},this.current_month=function(){return this.schedule_get(this.dates(this.y,this.m))},this.schedule_get=function(e){let t=this.Common.markedDates(),s=this.Common.holidays(),i=this.Common.rest_days(),n=this.Common.rest_dt(),a=this.Common.times(Date.now()),r=[];for(const e in a)if(Object.hasOwnProperty.call(a,e)){const t=new Date(e).getHours(),s=new Date(e).getMinutes(),i=this.Common.pad(t)+":"+this.Common.pad(s);r.push(i)}r.sort();let o='<div class="clear shed_wrap">                        <table class="tc_table">                          <thead class=""><tr class="headdate"><th class="tc_td headcol head">&nbsp;</th>',l=[],d={};for(const[e,t]of Object.entries(this.CalSet.orgWeekend))""===t?l.push(`${e}`):d[e]=t;for(let n=0;n<e.length;n++){const a=e[n];let r="tc_disabled"===(a in t?"tc_"+t[a]:"")?"tc_checked":"";""===r&&(l.includes(this.CalSet.dw[a.getDay()])||s.includes(a.getTime())||i.includes(a.getTime()))&&(r="tc_checked"),o+='<th class="tc_td '+r+' head" id="d_'+new Date(a).getTime()+'">'+this.Common.capitalizeFirstLetter(this.Common.getDayName(a,this.CalSet.locale,this.CalSet.long))+"<br />"+this.Common.pad(new Date(a).getDate())+"."+this.Common.pad(new Date(a).getMonth()+1)+"</th>"}o+='</tr></thead><tbody class="master_times">';for(let t=0;t<r.length;t++){const a=r[t],c=a.split(":");o+='<tr class=""><td class="tc_td headcol">'+a+"</td>";for(let t=0;t<e.length;t++){const a=new Date(new Date(e[t]).setHours(c[0],c[1],0,0));let r="";if((l.includes(this.CalSet.dw[e[t].getDay()])||s.includes(e[t].getTime())||i.includes(e[t].getTime()))&&(r="tc_checked"),""===r&&e[t]in n){const s=n[e[t]];a in s&&"disabled"===s[a]&&(r="tc_checked")}let m=this.Common.lunch(e[t]),h=m[0],u=m[1];if(a>=h&&a<u&&(r="tc_checked"),d.hasOwnProperty(this.CalSet.dw[e[t].getDay()])){let s=d[this.CalSet.dw[e[t].getDay()]].split(":"),i=new Date(new Date(e[t]).setHours(s[0],s[1],0,0));a.getTime()>=i.getTime()&&(r="tc_checked")}o+='<td class="'+r+' tc_td" id ="d_'+e[t].getTime()+"dt_"+a.getTime()+'">&nbsp;</td>'}o+="</tr>"}return o+="   </tbody>                    </table>                  </div>",o},this.listener=function(){let e=this,t={month:"long",year:"numeric"},s='<div class="text_center hor_center schedule_caption">                            <span id="btnPre"> < </span>                            <span class="month">'+this.Common.capitalizeFirstLetter(new Date(this.y,this.m,1,0,0,0,0).toLocaleDateString(this.CalSet.locale,t)).slice(0,-2)+'</span>                            <span id="btnNex"> > </span>                          </div>                          <div id="shed"></div>';this.divForTimeChoice.innerHTML=s,document.querySelector("#shed").innerHTML=this.current_month();let i=document.getElementById("btnNex");document.getElementById("btnPre").onclick=function(){document.querySelector("#shed").innerHTML=e.prev_month(),document.querySelector(".month").innerHTML=e.Common.capitalizeFirstLetter(new Date(e.y,e.m,1,0,0,0,0).toLocaleDateString(e.CalSet.locale,t)).slice(0,-2),e.listener()},i.onclick=function(){document.querySelector("#shed").innerHTML=e.next_month(),document.querySelector(".month").innerHTML=e.Common.capitalizeFirstLetter(new Date(e.y,e.m,1,0,0,0,0).toLocaleDateString(e.CalSet.locale,t)).slice(0,-2),e.listener()};let n=(new Date).setHours(0,0,0,0),a=document.getElementById("d_"+n);a&&a.scrollIntoView({behavior:"smooth",block:"nearest",inline:"start"}),document.querySelector(".headdate").addEventListener("click",(function(e){let t=e.target.id;const s=document.querySelectorAll("[id^="+t+"]"),i=document.createElement("input");i.type="hidden",i.value=t.slice(2),i.id="i"+t;let n=document.querySelector("#"+i.id);n?(n.parentNode.removeChild(n),e.target.classList.contains("tc_mark_for_del")&&(e.target.classList.remove("tc_mark_for_del"),e.target.classList.add("tc_checked"),s.forEach((function(e){e.classList.remove("tc_mark_for_del"),e.classList.add("tc_checked")}))),e.target.classList.contains("tc_mark_for_add")&&(e.target.classList.remove("tc_mark_for_add"),s.forEach((function(e){e.classList.remove("tc_mark_for_add")})))):(e.target.classList.contains("tc_checked")?(i.name="deldate[]",e.target.classList.remove("tc_checked"),e.target.classList.add("tc_mark_for_del"),s.forEach((function(e){e.classList.remove("tc_checked"),e.classList.add("tc_mark_for_del")}))):(i.name="adddate[]",e.target.classList.add("tc_mark_for_add"),s.forEach((function(e){e.classList.add("tc_mark_for_add")}))),document.querySelector(".shed_wrap").appendChild(i))})),(new Date).getTime(),document.querySelector(".master_times").addEventListener("click",(function(e){let t=e.target.id,s=t.split("dt_")[1];const i=document.createElement("input");i.type="hidden",i.name="deltime[]",i.id="dt"+t,i.value=s;let n=document.querySelector("#dt"+t);n?(n.parentNode.removeChild(n),e.target.classList.contains("tc_mark_for_del")&&(e.target.classList.remove("tc_mark_for_del"),e.target.classList.add("tc_checked")),e.target.classList.contains("tc_mark_for_add")&&e.target.classList.remove("tc_mark_for_add")):(e.target.classList.contains("tc_checked")?(i.name="deltime[]",e.target.classList.remove("tc_checked"),e.target.classList.add("tc_mark_for_del")):(i.name="daytime[]",e.target.classList.add("tc_mark_for_add")),document.querySelector(".shed_wrap").appendChild(i))}));let r=document.querySelector("#"+e.FormConfig.buttonResetId),o=document.querySelector("#"+e.FormConfig.buttonSubmitId),l=document.getElementById(e.FormConfig.formId);l&&l.addEventListener("click",(function(t){r&&(r.disabled=!1),o&&(o.disabled=!1),t.target.id==e.FormConfig.buttonResetId&&(document.querySelectorAll(".tc_mark_for_add").forEach((e=>{e.classList.remove("tc_mark_for_add")})),document.querySelectorAll(".tc_mark_for_del").forEach((e=>{e.classList.remove("tc_mark_for_del"),e.classList.add("tc_checked")})),document.querySelectorAll("input").forEach((e=>{e.classList.contains("buttons")||e.remove()}))),t.target.id==e.FormConfig.buttonSubmitId&&(document.querySelectorAll("input").length>0?l.submit():e.modalAlert("Выберите дату или время"))}))}}}function h(e,t,s,i,n){new m(e,t,s,i,n).listener()}class u{constructor(e,t,s,i,n,a,r,o,l){this.CalSetUpdated=e,this.FormConfig=t,this.divForTimeChoice=s,this.CommonFunc=i,this.modalAlert=n,this.ServDurationCheck=a,this.shortCalendar=r,this.monthCalendar=o,this.scheduleCalendar=l}printCal(e,t="",s="",i="",n=""){"short"===e&&this.shortCalendar(this.CommonFunc,this.CalSetUpdated,this.divForTimeChoice,this.ServDurationCheck),"schedule"===e&&this.scheduleCalendar(this.CalSetUpdated,this.FormConfig,this.divForTimeChoice,this.CommonFunc,this.modalAlert),"month"===e&&this.monthCalendar(this.CommonFunc,this.CalSetUpdated,this.divForTimeChoice,this.ServDurationCheck)}}function _(o,d="",m="",_="",f=""){Date.prototype.addHours=function(e){return this.setTime(this.getTime()+60*e*60*1e3),this},function(e){const t=document.querySelector(e.appointmentTag);if(t){let s=document.createElement("FORM");s.id=e.formId,s.name=e.formId,s.method=e.formMethod;let i=document.createElement("DIV");i.id=e.divForTimeChoiceId;let n=document.createElement("DIV");n.className=e.buttonsDivClassName,n.id=e.buttonsDivId;let a=document.createElement("BUTTON");a.type="button",a.className=e.buttonsSubmitClassName,a.id=e.buttonSubmitId,a.disabled=!0;let r=document.createTextNode(e.buttonSubmitText);a.appendChild(r),n.appendChild(a);let o=document.createElement("BUTTON");o.type="button",o.className=e.buttonsResetClassName,o.id=e.buttonResetId,o.disabled=!0;let l=document.createTextNode(e.buttonResetText);o.appendChild(l),n.appendChild(o),n.appendChild(a),s.appendChild(i),s.appendChild(n),t.appendChild(s)}}(s);let g=document.querySelector(`#${s.divForTimeChoiceId}`),p=new i(e,t);if(""==d||"undefined"==d||null==d){let t=new n(s,e),i=new r(e,s,g,t,a);new u(e,s,g,t,a,i,c,l,h).printCal(o,d,m,_,f)}else p.data_from_db(d,m,_,f).then((e=>{p.setCalsetValue(e,p.data);let t=new n(s,p.data),i=new r(p.data,s,g,t,a);new u(p.data,s,g,t,a,i,c,l,h).printCal(o,d,m,_,f)})).catch((function(e){console.log("Fetch Error :-S",e)}))}export{_ as printCalendar};
